# Установка и настройка Flask приложения с помощью Gunicorn и Systemd

## Описание

Этот проект представляет собой приложение на языке Python, разработанное с использованием фреймворка Flask. Оно предназначено для отображения статистики подключений клиентов к OpenVPN серверу. Основная цель приложения — визуализировать информацию о подключенных клиентах и их трафике в удобном формате.

## Требования

Для успешной установки необходимо, чтобы на сервере были установлены следующие компоненты:
- Python 3.12 или выше
- Права суперпользователя (root)
- Ubuntu 24.04

## Шаги установки

1. Обновите пакеты и установите Git:

    ```bash
    sudo apt update && sudo apt install -y git
    ```

2. Клонируйте репозиторий и установите необходимые права на выполнение скрипта:

    ```bash
    git clone https://github.com/TheMurmabis/StatusOpenVPN.git web && chmod +x web/setup.sh
    ```

3. Запустите установочный скрипт:

    ```bash
    sudo web/setup.sh
    ```

4. В процессе установки будет предложено изменить порт по умолчанию (1234). Вы можете ввести новый порт, если хотите, или оставить его без изменений.

5. После завершения установки приложение будет доступно по адресу:

    ```
    http://<внешний IP>:<порт>
    ```
    
    Например:

    ```
    http://192.168.1.1:1234
    ```

## Структура проекта

- `setup.sh` - Скрипт для автоматической установки и настройки приложения.
- `requirements.txt` - Список зависимостей Python, необходимых для работы приложения.
- `myapp.service` - Systemd unit файл для управления сервисом Flask приложения.

## Скрипт установки

Скрипт `setup.sh` выполняет следующие действия:

1. **Клонирует репозиторий** в директорию `/root/web`.
2. **Создает виртуальное окружение Python**.
3. **Устанавливает зависимости** из файла `requirements.txt`.
4. **Настраивает Gunicorn** для запуска Flask приложения.
5. **Создает systemd unit файл** для управления сервисом.
6. **Запускает сервис** и проверяет его статус.
7. **Удаляет временные файлы** (`setup.sh` и `README.md`), чтобы они не занимали место и не мешали.

## Изменение порта

Если вам нужно изменить порт, на котором работает приложение, запустите скрипт повторно и выберите новый порт. Скрипт проверит, свободен ли указанный порт, и предложит повторный ввод в случае занятости.

## Управление сервисом

После установки вы можете управлять сервисом с помощью команд systemctl:

- **Запустить сервис:**

    ```bash
    sudo systemctl start myapp
    ```

- **Остановить сервис:**

    ```bash
    sudo systemctl stop myapp
    ```

- **Перезапустить сервис:**

    ```bash
    sudo systemctl restart myapp
    ```

- **Проверить статус сервиса:**

    ```bash
    sudo systemctl status myapp
    ```

## Удаление

Для удаления сервиса и всех его компонентов выполните следующие команды:

1. Остановите и отключите сервис:

    ```bash
    sudo systemctl stop myapp
    sudo systemctl disable myapp
    ```

2. Удалите systemd unit файл:

    ```bash
    sudo rm /etc/systemd/system/myapp.service
    ```

3. Перезагрузите systemd:

    ```bash
    sudo systemctl daemon-reload
    ```

4. Удалите директорию с проектом:

    ```bash
    sudo rm -rf /root/web
    ```

## Примечания

- Убедитесь, что ваш сервер имеет открытый порт, на котором будет работать ваше приложение.
- Если вы используете облачный сервер, убедитесь, что правила брандмауэра (firewall) позволяют входящие подключения на указанный порт.

## Об авторе

Этот проект был создан и поддерживается пользователем **TheMurmabis**. Для любых вопросов или предложений, пожалуйста, обращайтесь через Issues на GitHub.
